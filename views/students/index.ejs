<%- include('../partials/header') %>
<h1>All Students</h1>

<!-- Search Form with Student Type Buttons (No "All") -->
<form action="/students" method="GET" class="search-form">
  <input type="text" name="name" placeholder="Search by name" value="<%= search.name || '' %>" />
  <input type="number" step="0.1" name="minGPA" placeholder="Min GPA" value="<%= search.minGPA || '' %>" />

  <div class="pg-filter">
    <label>Student type</label>
    <button type="submit" name="isPG" value="true" class="<%= search.isPG === 'true' ? 'active' : '' %>">
      Graduate Student
    </button>
    <button type="submit" name="isPG" value="false" class="<%= search.isPG === 'false' ? 'active' : '' %>">
      Undergraduate Student
    </button>
  </div>
</form>

<ul class="student-list">
  <% if (students.length === 0) { %>
    <p>No students found.</p>
  <% } else { %>
    <% students.forEach(s => { %>
      <li class="student-item">
        <div class="info">
          <strong><%= s.name %></strong>
          (ID: <%= s.studentId %>)
          – GPA: <%= s.gpa %>
          – <%= s.isPG ? 'Graduate' : 'Undergraduate' %> Student
        </div>
        <div class="actions">
          <a href="/students/<%= s._id %>/edit">Edit</a>
          <form action="/students/<%= s._id %>?_method=DELETE" method="POST" style="display:inline">
            <button type="submit" class="delete-btn" onclick="return confirm('Delete this student?')">
              Delete
            </button>
          </form>
        </div>
      </li>
    <% }) %>
  <% } %>
</ul>

<%- include('../partials/footer') %>
